<!DOCTYPE html>
<html lang="en-GB">
<head>
  <meta charset="utf-8">
  <title></title>
  <meta name="description" content="## Digging into jQuery.Deferred

Learning to use Promises, the soft way.

@@@

## Consume the API

In jQuery 1.8+: `$.ajax`, `$.animate`, `$('<selector>')`

<br>

```
var $deferred = $.post('/cheese', {
  name: "Livarot"
});

$deferred
  .done( syncLocalStorage )
  .done( updateUI )
  .fail( displayError )
  .always( logNetworkResponse );
```

@@@

## Create your first Deferred

```
function getDelayedUserInput(){
  var $deferred = $.Deferred();

  setTimeout(function(){
    $deferred.resolve(prompt("Anything to say?"));
  }, 1000);

  return $deferred;
}

$('input').on('click', function(e){
  getDelayedUserInput().done(function(user_input){
    $(e.target).val(user_input);
  });
});
```
<small>[See on JSBin](http://jsbin.com/ocadol/3/edit).</small>

@@@

## Deal with race condition workflows

* `then()` enables data filtering.
* `when()` is a `done()` for multiple promises.

```
$.when( $.getJSON('/page/1'), $.getJSON('/page/2') )
  .then(function(page1_data, page2_data){
    return page1_data.concat(page2_data);
  })
  .done( displayCombinedData )
  .fail( displayError );
```

@@@

## Sharing safely your Deferred

`jQuery.Deferred` vs. `Deferred.promise()`.

<br>

```
var $deferred = $.Deferred();
var $promise = $deferred.promise();

$promise.done(function(value){
  console.log("Oh my "+value);
});

// $promise is read-only
$promise.resolve("gosh");

// will log 'Oh my head'
$deferred.resolve("head");
```

<small>[See on JSBin](http://jsbin.com/uzokam/1/edit).</small>

@@@

## Improving our first Deferred

```
function getDelayedUserInput(){
  var $deferred = $.Deferred();

  setTimeout(function(){
    $deferred.resolve(prompt("Anything to say?"));
  }, 1000);

  return $deferred.promise(); // now safe
}

$('input').on('click', function(e){
  getDelayedUserInput().done(function(user_input){
    $(e.target).val(user_input);
  });
});
```

<small>[See on JSBin](http://jsbin.com/ocadol/4/edit).</small>

">
  <meta name="author" content="Thomas Parisot">
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

  <link rel="stylesheet" href="../../../bower_components/reveal.js/css/reveal.min.css">
  <link rel="stylesheet" href="../../../bower_components/css.oncletom.io/dist/core.min.css">
  <link rel="stylesheet" href="../../../src/css/reveal.css" id="theme">
  <link rel="stylesheet" href="../../../src/css/layout.css">

  <link rel="stylesheet" href="../../../bower_components/reveal.js/lib/css/zenburn.css">
</head>

<body>

<div class="reveal">

  <div class="slides">
    
  </div>

</div>

<script src="../../../bower_components/reveal.js/lib/js/head.min.js"></script>
<script src="../../../bower_components/reveal.js/js/reveal.min.js"></script>

<script src="../../../src/js/bootstrap.js"></script>
</body>
</html>
