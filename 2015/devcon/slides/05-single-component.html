<!-- .slide: data-state="contrasted" -->
<h2 id="single-component"><strong>Single</strong> component</h2>
<p>@@@</p>
<h2 id="immutable-build"><strong>Immutable</strong> build</h2>
<pre><code class="language-bash">docker build -t oncletom/devcon-nodejs-app

Step 0 : FROM node:4-slim
 ---&gt; 81876916bca2
Step 1 : WORKDIR /app
 ---&gt; Using cache
 ---&gt; 44a4f0b3ef85
Step 2 : COPY package.json ./package.json
 ---&gt; Using cache
 ---&gt; 48cf3e569dc8
Step 3 : RUN npm install
...
</code></pre>
<p>@@@</p>
<h2 id="run">Run</h2>
<pre><code class="language-bash">docker run -ti oncletom/devcon-nodejs-app
</code></pre>
<p>@@@</p>
<h2 id="explicit-behaviour"><strong>Explicit</strong> behaviour</h2>
<p>Nothing happened unless <em>requested</em>.</p>
<p>@@@</p>
<h2 id="port-binding-w-host">Port binding w/ <em>host</em></h2>
<pre><code class="language-bash"># docker run -p [net-interface:host-port]:internal-port &lt;image&gt;
docker run -ti -p 0.0.0.0:5000:3000 oncletom/devcon-nodejs-app
</code></pre>
<p>@@@</p>
<h2 id="port-binding-w-containers">Port binding w/ <em>containers</em></h2>
<pre><code class="language-bash">docker run -d --name app oncletom/devcon-nodejs-app

docker run -ti --link &quot;app:app_alias&quot; oncletom/devcon-nodejs-app &lt;command&gt;
</code></pre>
<pre><code>
```
docker run -ti --link &quot;app:app_alias&quot; oncletom/devcon-nodejs-app env
docker run -ti --link &quot;app:app_alias&quot; oncletom/devcon-nodejs-app ping app_alias
docker run -ti --link &quot;app:app_alias&quot; oncletom/devcon-nodejs-app curl http://app:app_alias:3000
```


@@@

## **Runtime** configuration

```bash
docker run -e KEY_VALUE --env-file=.env-file &lt;container&gt;
```

```
# .env-file
NODE_ENV=test
DATABASE_URL=postgresql://host:port/db?pool=25
```

&lt;footer&gt;Think [Twelve-Factor](http://12factor.net/).&lt;/footer&gt;

</code></pre>
<pre><code>docker run -ti --rm -p 0.0.0.0:5000:3000 -e MOTD=&quot;Hello Devcon&quot; oncletom/devcon-nodejs-app
</code></pre>
<p>@@@</p>
<h2 id="multiply">Multiply!</h2>
<pre><code class="language-bash">docker run -d -P oncletom/devcon-nodejs-app
docker run -d -P oncletom/devcon-nodejs-app
docker run -d -P oncletom/devcon-nodejs-app
docker run -d -P oncletom/devcon-nodejs-app
docker run -d -P oncletom/devcon-nodejs-app

# â€¦

docker ps
</code></pre>
<pre><code>
```
docker inspect -f '{{range $p, $conf := .NetworkSettings.Ports}}{{(index $conf 0).HostPort}}{{end}}' $(docker ps -q)
```
</code></pre>
